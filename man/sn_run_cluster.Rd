% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/integrate.R
\name{sn_run_cluster}
\alias{sn_run_cluster}
\title{Integrate multiple batches using Harmony + optional blocklist genes}
\usage{
sn_run_cluster(
  object,
  batch = NULL,
  nfeatures = 3000,
  vars_to_regress = NULL,
  resolution = 0.8,
  block_genes = c("ribo", "mito", "tcr", "immunoglobulins", "noncoding", "pseudogenes"),
  theta = 2,
  npcs = 50,
  dims_use = 1:20,
  species = NULL,
  return_cluster = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{object}{A \code{Seurat} object.}

\item{batch}{A column name in \code{object@meta.data} specifying batch info.}

\item{nfeatures}{Number of variable features to select.}

\item{vars_to_regress}{Covariates to regress out in \code{ScaleData}.}

\item{resolution}{Resolution parameter for \code{FindClusters}.}

\item{block_genes}{Either a character vector of predefined sets (e.g. \code{c("ribo","mito")})
if \code{SignatuR} is installed, or a custom vector of gene symbols to exclude from HVGs.}

\item{theta}{The \code{theta} parameter for \code{harmony::RunHarmony}, controlling batch
diversity preservation vs. correction.}

\item{npcs}{Number of PCs to compute in \code{RunPCA}.}

\item{dims_use}{A numeric vector of PCs (dimensions) to use for \code{Harmony} and subsequent steps.}

\item{verbose}{Whether to print/log progress messages.}
}
\value{
A \code{Seurat} object with integrated data (Harmony reduction), cell cycle scores,
  clusters, and UMAP embeddings.
}
\description{
This function demonstrates a workflow to integrate multiple batches
using \code{Harmony}, with optional blocklist-based HVG filtering.
It also does cell cycle scoring, HVG detection, scaling, PCA, clustering,
and UMAP. Compatible with Seurat v5 functions for integration.
}
\examples{
\dontrun{
seurat_obj <- sn_run_cluster(
  object = seurat_obj,
  batch = "sample_id",
  nfeatures = 3000,
  resolution = 0.5,
  block_genes = c("ribo", "mito") # or a custom vector of gene symbols
)
}
}
